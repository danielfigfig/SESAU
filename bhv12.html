<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Controle de Leitos</title>
    <style>
        body { font-family: 'Arial', sans-serif; background-color: #f0f2f5; }
        .tabs-container { margin-bottom: 1rem; border-bottom: 2px solid #ccc; }
        .tab-button {
            padding: 10px 15px; cursor: pointer; border: 1px solid #ccc; border-bottom: none;
            background-color: #e9e9e9; margin-right: 4px; border-radius: 6px 6px 0 0;
            font-weight: bold; color: #555; transition: background-color 0.3s, color 0.3s;
        }
        .tab-button.active { background-color: #0070c0; color: white; border-color: #0070c0; }
        .bed-pane, .control-pane { display: none; }
        .bed-pane.active, .control-pane.active { display: block; }
        .table-custom { border-collapse: collapse; width: 100%; max-width: 1400px; margin: auto; }
        .table-custom th, .table-custom td {
            border: 1px solid #000; padding: 0; text-align: center; font-size: 12px;
            min-width: 60px; height: 30px; box-sizing: border-box; position: relative;
        }
        .table-custom th { background-color: #f0f0f0; font-weight: bold; white-space: nowrap; padding: 5px 6px; }
        .input-icon-wrapper { display: flex; align-items: center; height: 100%; width: 100%; background-color: white; }
        .table-custom input[type="number"] {
            width: 100%; height: 100%; border: none; text-align: center; font-size: 12px;
            padding: 4px 2px; box-sizing: border-box; -moz-appearance: textfield; background-color: transparent;
        }
        .table-custom input[type="number"]::-webkit-outer-spin-button,
        .table-custom input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .col-time { font-weight: bold; color: white; width: 45px; min-width: 45px; }
        .col-j { border-left: 2px solid black !important; border-right: 2px solid black !important; }
        .bg-red-custom { background-color: #ff0000; }
        .bg-blue-custom { background-color: #0070c0; }
        .bg-green-custom-input { background-color: #c6efce; color: #006100; }
        .border-b-black-strong { border-bottom: 2px solid black; }
        .total-cell-actions { display: flex; justify-content: space-between; align-items: center; padding: 0 2px; height: 100%; }
        .footer-button {
            cursor: pointer; color: white; border: none; border-radius: 4px;
            width: 18px; height: 18px; font-size: 14px; line-height: 18px;
            text-align: center; font-weight: bold; transition: background-color 0.2s;
        }
        .clear-col-button { background-color: #e57373; }
        .clear-col-button:hover { background-color: #c00000; }
        .total-cell-value { flex-grow: 1; text-align: center; font-weight: bold; }
        .total-cell-clear { cursor: pointer; color: #c00000; font-weight: bold; }
        .total-cell-clear:hover { color: #ff0000; }
        .summary-input input[type="number"] {
            font-size: 18px !important; font-weight: bold; border: 2px solid #0070c0 !important;
            background-color: #f0f8ff !important; text-align: center; padding: 8px !important; border-radius: 6px;
        }
        .summary-input input[readonly] { background-color: #e9ecef !important; border-color: #ced4da !important; }
        .footer-controls { display: flex; justify-content: flex-end; align-items: center; padding: 8px; gap: 20px; }
        .completion-status-wrapper { display: flex; align-items: center; font-size: 14px; }
        .completion-checkbox { width: 20px; height: 20px; cursor: pointer; }
        .save-button {
            background-color: #0070c0; color: white; font-weight: bold; padding: 8px 16px;
            border-radius: 5px; border: none; cursor: pointer; transition: background-color 0.3s;
        }
        .save-button:hover { background-color: #005a9a; }
        #control-panel-status { list-style: none; padding: 0; margin-top: 20px; }
        .status-item { font-size: 1.1rem; padding: 10px 15px; border-radius: 5px; margin-bottom: 8px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .status-item .balance { font-weight: normal; font-size: 1rem; color: #333; background-color: rgba(255, 255, 255, 0.5); padding: 2px 8px; border-radius: 10px; }
        .status-item.completed { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status-item.incomplete { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal-content { background: white; padding: 30px; border-radius: 8px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.3); max-width: 400px; }
        .modal-content button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 0 10px; }
        #confirm-clear-btn { background-color: #dc3545; color: white; }
        #cancel-clear-btn { background-color: #6c757d; color: white; }
        #firebase-status { position: fixed; top: 10px; right: 10px; background-color: #6c757d; color: white; padding: 5px 15px; border-radius: 15px; font-size: 12px; font-weight: bold; z-index: 1000; }
        #firebase-status.saving { background-color: #ffc107; color: black; }
        #firebase-status.saved { background-color: #28a745; }
    </style>
</head>
<body class="p-2 sm:p-4">

    <div id="firebase-status">Conectando...</div>

    <div id="appContainer" class="bg-white shadow-lg p-4 rounded-lg w-full">
        <div class="tabs-container overflow-x-auto whitespace-nowrap"></div>
        <div class="beds-content"></div>
    </div>
    
    <div id="confirm-modal" class="modal-overlay">
        <div class="modal-content">
            <p>Tem certeza que deseja apagar TODOS os dados de TODOS os 10 leitos? Esta ação não pode ser desfeita.</p>
            <button id="confirm-clear-btn">Sim, Apagar Tudo</button>
            <button id="cancel-clear-btn">Cancelar</button>
        </div>
    </div>

<script type="module">
    // Firebase SDK Imports (usando a versão mais recente e modular)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, onSnapshot, writeBatch } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // <<< ALTERAÇÃO PRINCIPAL AQUI >>>
    // Substitua os valores abaixo pelos dados do SEU projeto Firebase.
    // Você encontra isso no Console do Firebase > Configurações do Projeto > Geral > Seus apps > Configuração do SDK.
    const firebaseConfig = {
      apiKey: "AIzaSyBRY_EgyfDJn...COLE_SUA_CHAVE_AQUI", // Substitua pelo seu
      authDomain: "strabalho-9a69a.firebaseapp.com",    // Substitua pelo seu
      projectId: "strabalho-9a69a",                     // Substitua pelo seu
      storageBucket: "strabalho-9a69a.appspot.com",   // Substitua pelo seu
      messagingSenderId: "849726685908",                // Substitua pelo seu
      appId: "1:849726685908:web:0295b9e02415a3c0aab141", // Substitua pelo seu
      measurementId: "G-Y6M28FKMF4"                     // Opcional, mas bom ter
    };

    // --- Inicialização do App ---
    document.addEventListener('DOMContentLoaded', function() {
        // App elements and state
        const appContainer = document.getElementById('appContainer');
        const tabsContainer = appContainer.querySelector('.tabs-container');
        const bedsContent = appContainer.querySelector('.beds-content');
        const statusIndicator = document.getElementById('firebase-status');
        const confirmModal = document.getElementById('confirm-modal');
        const confirmClearBtn = document.getElementById('confirm-clear-btn');
        const cancelClearBtn = document.getElementById('cancel-clear-btn');
        const numberOfBeds = 10;
        
        let db, auth, userId;
        let isUpdatingFromFirestore = false;
        let unsubscribers = [];
        let debounceTimer;

        // --- Geração da Interface (HTML Dinâmico) ---
        const generateBedHTML = () => {
             const hours = [19, 20, 21, 22, 23, 24, 1, 2, 3, 4, 5, 6];
             const cols = [
                 { id: 'b', label: 'INS' }, { id: 'c', label: 'VO' }, { id: 'd', label: 'PLA' }, { id: 'e', label: 'MED' }, { id: 'f', label: 'NOR' }, { id: 'g', label: 'DOR' },
                 { id: 'h', label: 'FEN' }, { id: 'i', label: 'BIC' }, { id: 'j', label: 'BIC' }, { id: 'k', label: 'HEM' }, { id: 'm', label: 'VO SNG' }, { id: 'n', label: 'DIUR' },
                 { id: 'o', label: 'EVA C' }, { id: 'p', label: 'HD' }, { id: 'q', label: 'DRE 1' }, { id: 'r', label: 'DRE 2' }
             ];
            
            const headerCells = cols.map(c => `<th class="${c.id === 'j' ? 'col-j' : ''}">${c.label.replace(' ', '<br>')}</th>`).join('');

            const bodyRows = hours.map(hour => {
                const timeCellClass = [19, 20, 21, 22, 23].includes(hour) ? 'bg-red-custom' : 'bg-blue-custom';
                const lastRowClass = hour === 6 ? 'border-b-black-strong' : '';
                const bInputClass = ![19, 20, 21, 22, 23].includes(hour) ? 'bg-green-custom-input' : '';
                
                const bodyCells = cols.map(c => `
                    <td class="${c.id === 'j' ? 'col-j' : ''}">
                        <div class="input-icon-wrapper ${c.id === 'b' ? bInputClass : ''}">
                            <input type="number" class="data-input" data-hour="${hour}" data-col="${c.id}" autocomplete="off">
                        </div>
                    </td>`).join('');
                
                const rowContent1 = cols.slice(0, 10).map((c, i) => bodyCells.split('</td>')[i]).join('</td>');
                const rowContent2 = cols.slice(10).map((c, i) => bodyCells.split('</td>')[i + 10]).join('</td>');

                return `<tr class="data-row ${lastRowClass}">
                            <td class="col-time ${timeCellClass}">${hour}</td>
                            ${rowContent1}</td>
                            <td class="col-time bg-gray-300 text-black">${hour}</td>
                            ${rowContent2}</td>
                        </tr>`;
            }).join('');
            
            const footerCells = cols.map(c => `
                <td class="${c.id === 'j' ? 'col-j' : ''}">
                    <div class="total-cell-actions">
                        <button class="footer-button clear-col-button" data-col="${c.id}" title="Limpar Coluna">X</button>
                        <span class="total-cell-value total-${c.id}">0</span>
                    </div>
                </td>`).join('');

            const footerContent1 = cols.slice(0, 10).map((c, i) => footerCells.split('</td>')[i]).join('</td>');
            const footerContent2 = cols.slice(10).map((c, i) => footerCells.split('</td>')[i+10]).join('</td>');

            return `
            <div class="bg-white w-full overflow-x-auto">
                <table class="table-custom">
                    <thead><tr><th>A</th>${cols.slice(0,10).map(c=>`<th class="${c.id === 'j' ? 'col-j' : ''}">${c.label}</th>`).join('')}<th>L</th>${cols.slice(10).map(c=>`<th>${c.label}</th>`).join('')}</tr></thead>
                    <tbody>${bodyRows}</tbody>
                    <tfoot>
                        <tr class="border-b-black-strong total-cell">
                            <td class="total-cell-clear" title="Limpar todos os valores deste leito">LIMPAR LEITO</td>
                            ${footerContent1}</td>
                            <td></td>
                            ${footerContent2}</td>
                        </tr>
                    </tfoot>
                </table>
                <div class="mt-6 p-3 bg-gray-50 rounded-md">
                    <table class="w-full">
                        <tbody>
                            <tr><td class="text-center font-bold">Manhã</td><td class="text-center font-bold">TARDE</td><td class="text-center font-bold">NOITE</td><td class="text-center font-bold" colspan="2">Balanço 24h</td></tr>
                            <tr>
                                <td class="summary-input"><input type="number" class="sumManha data-input" data-col="sumManha" autocomplete="off"></td>
                                <td class="summary-input"><input type="number" class="sumTarde data-input" data-col="sumTarde" autocomplete="off"></td>
                                <td class="summary-input"><input type="number" class="sumNoite data-input" data-col="sumNoite" readonly></td>
                                <td class="summary-value text-blue-dark text-center balanco24h" colspan="2" style="font-size: 20px; font-weight: bold;">0</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="footer-controls">
                        <div class="completion-status-wrapper"><label>Preenchimento Concluído:</label><input type="checkbox" class="completion-checkbox data-input" data-col="isComplete"></div>
                        <button class="save-button">Forçar Salvamento</button>
                    </div>
                </div>
            </div>`;
        };
        
        // --- Setup da UI e do Firebase ---
        function setupUI() {
            for (let i = 0; i < numberOfBeds; i++) {
                const tab = document.createElement('button'); tab.className = 'tab-button'; tab.textContent = `Leito ${i + 1}`; tab.dataset.targetPane = `bed-${i}`; tabsContainer.appendChild(tab);
                const pane = document.createElement('div'); pane.className = 'bed-pane'; pane.id = `bed-${i}`; pane.dataset.bedIndex = i; pane.innerHTML = generateBedHTML(); bedsContent.appendChild(pane);
            }
            const controlTab = document.createElement('button'); controlTab.className = 'tab-button'; controlTab.textContent = 'Controle'; controlTab.dataset.targetPane = 'control-pane'; tabsContainer.appendChild(controlTab);
            const controlPane = document.createElement('div'); controlPane.className = 'control-pane p-4'; controlPane.id = 'control-pane'; controlPane.innerHTML = `<h2 class="text-xl font-bold mb-4">Painel de Controle Geral</h2><button id="clear-all-beds-btn" style="background-color:#dc3545; color:white; padding:8px 12px; border-radius:5px; cursor:pointer;">Limpar Todos os Leitos</button><ul id="control-panel-status" class="mt-4"></ul>`; bedsContent.appendChild(controlPane);
            
            tabsContainer.querySelector('.tab-button').classList.add('active'); 
            bedsContent.querySelector('.bed-pane').classList.add('active');
            
            document.getElementById('clear-all-beds-btn').addEventListener('click', () => { confirmModal.style.display = 'flex'; });
        }
        
        async function initializeFirebase() {
            try {
                // Verificamos se a chave da API foi alterada. Se não, mostramos um alerta.
                if (firebaseConfig.apiKey.includes("COLE_SUA_CHAVE_AQUI")) {
                    throw new Error("Configuração do Firebase não foi preenchida. Edite o arquivo HTML.");
                }
                
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                onAuthStateChanged(auth, user => {
                    if (user) {
                        userId = user.uid;
                        statusIndicator.textContent = 'Conectado';
                        statusIndicator.className = 'saved';
                        console.log("Autenticado com ID:", userId);
                        loadAllBedsData(); // Carrega dados quando autenticado
                    } else {
                        // Se não houver usuário, tenta fazer login anônimo.
                        signInAnonymously(auth).catch(error => {
                           console.error("Erro no login anônimo:", error);
                           statusIndicator.textContent = 'Falha na autenticação';
                           statusIndicator.style.backgroundColor = '#dc3545';
                        });
                    }
                });

            } catch (error) {
                console.error("Falha na inicialização do Firebase:", error);
                statusIndicator.textContent = `${error.message}`;
                statusIndicator.style.backgroundColor = '#dc3545';
            }
        }
        
        // --- Manipulação de Dados (Salvar e Carregar) ---
        function getBedDataFromPane(pane) {
            const data = {};
            pane.querySelectorAll('.data-input').forEach(input => {
                const key = `${input.dataset.col}_${input.dataset.hour || 'summary'}`;
                if(input.type === 'checkbox') {
                    data[input.dataset.col] = input.checked;
                } else if(input.value !== '') {
                    data[key] = input.value;
                }
            });
            return data;
        }

        function setPaneDataFromSnapshot(pane, data) {
            isUpdatingFromFirestore = true;
            // Limpa todos os campos antes de preencher
            pane.querySelectorAll('.data-input').forEach(input => {
                if (input.type === 'checkbox') input.checked = false;
                else input.value = '';
            });

            // Preenche com os dados do Firebase
            if(data) {
                Object.keys(data).forEach(key => {
                    const input = pane.querySelector(`[data-col="${key.split('_')[0]}"][data-hour="${key.split('_')[1]}"]`) || pane.querySelector(`[data-col="${key}"]`);
                    if(input) {
                        if (input.type === 'checkbox') {
                            input.checked = data[key];
                        } else {
                            input.value = data[key];
                        }
                    }
                });
            }
            calculateAllTotals(pane);
            isUpdatingFromFirestore = false;
        }

        async function saveBedData(bedIndex) {
            if (!userId) return;
            const pane = bedsContent.querySelector(`#bed-${bedIndex}`);
            if (!pane) return;
            
            calculateAllTotals(pane); // Garante que os totais estão atualizados antes de salvar
            const data = getBedDataFromPane(pane);
            
            statusIndicator.textContent = 'Salvando...';
            statusIndicator.className = 'saving';
            
            try {
                // O caminho no banco de dados agora é mais simples
                const docRef = doc(db, 'leitos', `leito_${bedIndex + 1}_user_${userId}`);
                await setDoc(docRef, data); // setDoc sobrescreve, o que é bom para manter os dados limpos
                statusIndicator.textContent = 'Salvo na nuvem';
                statusIndicator.className = 'saved';
                setTimeout(() => { if(statusIndicator.textContent === 'Salvo na nuvem') statusIndicator.textContent = 'Conectado'; }, 2000);
            } catch (error) {
                console.error("Falha ao salvar dados:", error);
                statusIndicator.textContent = 'Erro ao salvar';
                statusIndicator.style.backgroundColor = '#dc3545';
            }
        }

        function loadAllBedsData() {
            if (!userId) return;
            
            unsubscribers.forEach(unsub => unsub()); // Cancela listeners antigos
            unsubscribers = [];

            for (let i = 0; i < numberOfBeds; i++) {
                const pane = bedsContent.querySelector(`#bed-${i}`);
                const docRef = doc(db, 'leitos', `leito_${i + 1}_user_${userId}`);
                
                const unsubscribe = onSnapshot(docRef, (docSnap) => {
                    // Ignora atualizações locais para evitar loop
                    if (docSnap.metadata.hasPendingWrites) return; 
                    
                    console.log(`Dados recebidos para Leito ${i + 1}`);
                    setPaneDataFromSnapshot(pane, docSnap.data());
                    updateControlPanelStatus();
                }, (error) => console.error(`Erro ao carregar Leito ${i+1}: `, error));
                
                unsubscribers.push(unsubscribe);
            }
        }
        
        // --- UI, Cálculos e Eventos ---
        function updateControlPanelStatus() {
            const statusList = document.getElementById('control-panel-status');
            if (!statusList) return;
            statusList.innerHTML = '';
            for (let i = 0; i < numberOfBeds; i++) {
                const pane = bedsContent.querySelector(`#bed-${i}`);
                const isComplete = pane.querySelector('.completion-checkbox').checked;
                const balanceValue = pane.querySelector('.balanco24h').textContent;
                const listItem = document.createElement('li');
                listItem.className = `status-item ${isComplete ? 'completed' : 'incomplete'}`;
                listItem.innerHTML = `<span>Leito ${i + 1} - ${isComplete ? 'Preenchido' : 'Pendente'}</span> <span class="balance">Balanço: ${balanceValue}</span>`;
                statusList.appendChild(listItem);
            }
        }

        function calculateAllTotals(pane) {
            const colsToSum = ['b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'm', 'n', 'o', 'p', 'q', 'r'];
            colsToSum.forEach(colId => {
                const sum = Array.from(pane.querySelectorAll(`tbody input[data-col="${colId}"]`))
                                 .reduce((acc, input) => acc + (parseFloat(input.value) || 0), 0);
                const totalCell = pane.querySelector(`tfoot .total-${colId}`);
                if (totalCell) totalCell.textContent = sum.toFixed(0);
            });

            let totalGanhosNoite = 0;
            const gainColumns = ['b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k'];
            gainColumns.forEach(colId => {
                totalGanhosNoite += Array.from(pane.querySelectorAll(`tbody input[data-col="${colId}"]`))
                                         .reduce((acc, input) => acc + (parseFloat(input.value) || 0), 0);
            });

            let totalPerdasNoite = 0;
            const lossColumns = ['m', 'n', 'o', 'p', 'q', 'r'];
            lossColumns.forEach(colId => {
                 totalPerdasNoite += Array.from(pane.querySelectorAll(`tbody input[data-col="${colId}"]`))
                                          .reduce((acc, input) => acc + (parseFloat(input.value) || 0), 0);
            });
            
            const sumNoiteInput = pane.querySelector('.sumNoite');
            if(sumNoiteInput) sumNoiteInput.value = (totalGanhosNoite - totalPerdasNoite).toFixed(0);

            const manha = parseFloat(pane.querySelector('.sumManha').value) || 0;
            const tarde = parseFloat(pane.querySelector('.sumTarde').value) || 0;
            const noite = parseFloat(sumNoiteInput.value) || 0;
            const balanco = manha + tarde + noite;
            const balancoDisplay = pane.querySelector('.balanco24h');
            balancoDisplay.textContent = balanco.toFixed(0);
        }
        
        // --- Listeners de Eventos ---
        tabsContainer.addEventListener('click', (event) => {
            const target = event.target;
            if (target.matches('.tab-button')) {
                const targetPaneId = target.dataset.targetPane;
                tabsContainer.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
                bedsContent.querySelectorAll('.bed-pane, .control-pane').forEach(p => p.classList.remove('active'));
                target.classList.add('active');
                document.getElementById(targetPaneId).classList.add('active');
                if (targetPaneId === 'control-pane') updateControlPanelStatus();
            }
        });
        
        appContainer.addEventListener('click', function(event) {
            const target = event.target;
            const pane = target.closest('.bed-pane');
            if (!pane) return;
            const bedIndex = parseInt(pane.dataset.bedIndex, 10);
            if (target.matches('.save-button')) { saveBedData(bedIndex); }
            if (target.matches('.clear-col-button')) { pane.querySelectorAll(`input[data-col="${target.dataset.col}"]`).forEach(input => input.value = ''); calculateAllTotals(pane); }
            if (target.matches('.total-cell-clear')) { pane.querySelectorAll('.data-input:not([readonly])').forEach(input => input.type === 'checkbox' ? input.checked = false : input.value = ''); calculateAllTotals(pane); saveBedData(bedIndex); }
        });
        
        appContainer.addEventListener('input', function(event) {
            if (isUpdatingFromFirestore) return;
            const target = event.target;
            const pane = target.closest('.bed-pane');
            if (pane) {
                calculateAllTotals(pane);
                if (target.matches('.completion-checkbox')) { updateControlPanelStatus(); }
                
                // Debounce saving
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    const bedIndex = parseInt(pane.dataset.bedIndex, 10);
                    saveBedData(bedIndex);
                }, 1500); // Salva 1.5 segundos após a última digitação
            }
        });

        appContainer.addEventListener('keydown', function(event) {
            if (!event.target.matches('.bed-pane input[type="number"]')) return;
            if (event.key === 'Enter') {
                event.preventDefault();
                const activeInput = event.target;
                const allInputs = Array.from(activeInput.closest('.bed-pane').querySelectorAll('tbody .data-input:not([readonly])'));
                const currentIndex = allInputs.indexOf(activeInput);
                const nextInput = allInputs[currentIndex + 1];
                if (nextInput) { nextInput.focus(); nextInput.select(); }
            }
        });
        
        cancelClearBtn.addEventListener('click', () => { confirmModal.style.display = 'none'; });
        confirmClearBtn.addEventListener('click', async () => {
             const batch = writeBatch(db);
             for (let i = 0; i < numberOfBeds; i++) {
                 const docRef = doc(db, 'leitos', `leito_${i + 1}_user_${userId}`);
                 batch.set(docRef, {}); // Define o documento como vazio
             }
             await batch.commit();
             console.log("Todos os leitos foram limpos no banco de dados.");
             confirmModal.style.display = 'none';
        });

        // --- Iniciar o App ---
        setupUI();
        initializeFirebase();
    });
</script>

</body>
</html>
